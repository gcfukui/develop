!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@grapecity/inputman"),require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/inputman","@grapecity/spread-sheets"],e):"object"==typeof exports?exports.InputManCellType=e(require("@grapecity/inputman"),require("@grapecity/spread-sheets")):t.InputManCellType=e(t.GC,t.GC)}(window,function(t,e){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(e,n){e.exports=t},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),o=function(){function t(t){this._instance=t}return t.Property=function(e){return function(e,n){var o=e;Array.isArray(t.typeInfos)||(t.typeInfos=[]);var r=i.ArrayHelper.find(t.typeInfos,o,function(t){return t.prototype});if(r)p=r.item;else{var p={prototype:o,derived:Object.getPrototypeOf(e),properties:[]};t.typeInfos.push(p)}var s=-1,a=i.ArrayHelper.find(p.properties,n);a&&(s=a.index),-1===s&&p.properties.push(n)}},t.prototype.defineProperties=function(){return this.defineInstanceProperties(Object.getPrototypeOf(this._instance))},t.prototype.defineInstanceProperties=function(e){if(e){var n=i.ArrayHelper.find(t.typeInfos,e,function(t){return t.prototype});if(n){var o=n.item;if(Array.isArray(o.properties)){var r=this;o.properties.forEach(function(t){var e="_"+t;Object.defineProperty(r._instance,t,{get:function(){return r._instance[e]},set:function(n){r._instance[e]=n;var i=r.getDefualtSetter(t),o=r._instance._imCtrl;if(o&&"function"==typeof o[i])try{o[i].apply(o,[n])}catch(n){}}})}),this.defineInstanceProperties(o.derived)}}}},t.prototype.getDefualtSetter=function(t){return"set"+t[0].toUpperCase()+t.substr(1,t.length)},t.prototype.getUsedProperties=function(){for(var e=this,n=Object.getPrototypeOf(this._instance),o=[];n;){var r=i.ArrayHelper.find(t.typeInfos,n,function(t){return t.prototype});if(!r)return o;r.item.properties.forEach(function(t){void 0!==e._instance[t]&&o.push({key:t,value:e._instance[t]})}),n=r.item.derived}return o},t.prototype.applyProperty=function(){var t=this;this.getUsedProperties().forEach(function(e){t._instance[e.key]=e.value})},t}();e.TypeManager=o},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,p=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(p=(r<3?o(p):3<r?o(e,n,p):o(e,n))||p);return 3<r&&p&&Object.defineProperty(e,n,p),p};Object.defineProperty(e,"__esModule",{value:!0});var p,s,a,l,u=n(0),c=n(7),y=n(1),f=n(9),h=y.TypeManager.Property,d=function(t){function e(e){var n=t.call(this)||this;return n._typeManager=new y.TypeManager(n),n._const_side_button="gcim__side-button",n._const_input_padding="0 2px",n._const_input_wrapper="gcim__input-wrapper",n._const_input_min_size={width:61,height:20},n._const_input_border_style="1px solid #CCCCCC",n._const_button_font_size=5,n._const_icon_spin_buttons="gcim-icon_spin-up, gcim-icon_spin-down",n._hAlignArray=["left","center","right"],n._const_unit="px",n._gcimct_input="border: none; border-radius: 0px; vertical-align: top",n._gcimct_input_layout="width: 100%; height: 100%;",n._gcim_Input_Helper="gcim_input_helper",n._config=e||{},n._typeManager.defineProperties(),n}return o(e,t),e.prototype.bindEvent=function(t){var e=this;this._imCtrl&&(this._imCtrl.onInvalidInput(function(){e.raiseEvent("invalidInput",t)}),this._imCtrl.onKeyExit(function(){e._isExiting=!0}),this._imCtrl.onInput(function(){e.raiseEvent("input",t)}))},e.prototype.createEditorElement=function(t){var e=this,n=document.createElement("div"),i=document.createElement("input");return i.classList.add(this._gcim_Input_Helper),i.style.cssText="width: 0px; height: 0px; border: none; padding: 0",i.tabIndex=-1,n.appendChild(i),i.addEventListener("keydown",function(t){if(e._imCtrl){var n=document.createEvent("UIEvents");n.initEvent("keydown",!0,!0),n.keyCode=t.keyCode,n.charCode=t.charCode,n.key=t.key,n.code=t.code,e._imCtrl.getUIInputElement().dispatchEvent(n)}},!1),n},e.prototype.updateEditor=function(t,e,n,i){this.processNavigationAction(i);var o=t.parentElement.parentElement;this._cellStyle=e,o.style.overflow="visible",this.syncSpreadStyle(t,e,i);var r=this.getBaseInputSize(t,i);if(r){r.width=Math.max(n.width,r.width+r.buttonsWidth),r.height=Math.max(n.height,r.height);var p=parseInt(o.style.width)<r.width,s=parseInt(o.style.height)<r.height;this.adjustControlSize(r,t,p,s)}},e.prototype.activateEditor=function(t,e,n,i){var o=document.createElement("input");t.appendChild(o);try{this._imCtrl=this.createGcInputManControl(o)}catch(t){this._imCtrl=u.InputMan.FindIMControl(o)}this.preventContextMenu(),this.bindEvent(i),this._typeManager.applyProperty(),this._isControlActived=!0},e.prototype.preventContextMenu=function(){this._imCtrl&&this._imCtrl.getLayoutElement().addEventListener("contextmenu",function(t){var e=t||window.event;"function"==typeof e.stopPropagation?e.stopPropagation():"boolean"==typeof e.cancelBubble&&(e.cancelBubble=!0),"function"==typeof e.preventDefault?e.preventDefault():"boolean"==typeof e.returnValue&&(e.returnValue=!1)},!0)},e.prototype.updateEditorContainer=function(t,e,n){var i=t.parentElement.parentElement,o=i.lastChild;o&&"gcEditorLabel"===o.getAttribute("gcUIElement")&&(o.style.width=parseInt(i.style.width)-2+this._const_unit)},e.prototype.processNavigationAction=function(t){var e=this;this._imCtrl.getUIInputElement().addEventListener("keydown",function(n){var i=t.sheet;if(i)try{var o=e.getDirectionFromKeyCode(n.keyCode);o==p.right?t.sheet.parent.commandManager().execute({cmd:"moveToNextCell",sheetName:i.name()}):o==p.left?t.sheet.parent.commandManager().execute({cmd:"moveToPreviousCell",sheetName:i.name()}):o==p.up?t.sheet.parent.commandManager().execute({cmd:"navigationUp",sheetName:i.name()}):o==p.down&&t.sheet.parent.commandManager().execute({cmd:"navigationDown",sheetName:i.name()}),o!=p.none&&(e._isControlActived=!1)}finally{e._isExiting=!1}})},e.prototype.getBaseInputSize=function(e,n){var i=n.sheet;if(i){var o=this._imCtrl.getText(),r=this._imCtrl.getValue();null!=o&&""!=o||(o=this._defaultText);var p=i.zoom();this._cellStyle.font=f.Core._getZoomFont(this._cellStyle.font,p).font;var s,a=t.prototype.getAutoFitHeight.call(this,r,o,this._cellStyle,1,n),l=e.getElementsByClassName(this._const_side_button);return s=this._const_input_min_size.height*p,{width:this._const_input_min_size.width-s*l.length,height:Math.max(a,this._const_input_min_size.height*p),buttonWidth:s,buttonsWidth:s*l.length,left:0}}},e.prototype.adjustControlSize=function(t,e,n,i){this.adjustBorder(this._gcimct_input,this._imCtrl.getUIInputElement(),this._imCtrl.getLayoutElement());var o=f.Core._getCellOffsetArray(this._cellStyle.cellPadding);this.adjustButtonSize(e,t,o);var r=e.parentElement.parentElement,p=o[1]+o[3],s=o[0]+o[2];(t.width+p>parseInt(r.style.width)||n)&&(r.style.width=t.width+p+this._const_unit),(t.height+s>parseInt(r.style.height)||i)&&(r.style.height=t.height+s+this._const_unit),e.style.cssText+="width: "+t.width+"px; height: "+t.height+"px",this._imCtrl.getUIInputElement().style.cssText+="width: "+(t.width-t.buttonsWidth)+"px; height: "+t.height+"px; padding: "+this._const_input_padding;var a=e.getElementsByClassName(this._const_input_wrapper);0<a.length&&(a[0].style.paddingLeft=t.left+this._const_unit),this._imCtrl.getLayoutElement().style.cssText+=this._gcimct_input_layout},e.prototype.adjustButtonSize=function(t,e,n){for(var i=t.getElementsByClassName(this._const_side_button),o=i.length,r=0;r<o;r++){var p=i[r];p.style.width=e.buttonWidth+this._const_unit,p.style.borderRadius="0px",0<n[0]&&(p.style.borderTop=this._const_input_border_style),0<n[1]&&(p.style.borderRight=this._const_input_border_style),0<n[2]&&(p.style.borderBottom=this._const_input_border_style),0<n[3]&&(p.style.borderLeft=this._const_input_border_style),2==o&&(0==e.left&&p.classList.contains("gcim__side-button_right-2")&&(p.style.right=e.buttonWidth+this._const_unit,p.style.borderRight="none"),e.left==e.buttonsWidth&&p.classList.contains("gcim__side-button_left-2")&&(p.style.left=e.buttonWidth+this._const_unit,p.style.borderLeft="none"))}},e.prototype.syncSpreadStyle=function(t,e,n){var i,o,r,p=n.sheet,s=this._imCtrl.getUIInputElement();p&&e&&(i=f.Core._getHAlignByValueType(3===e.hAlign?this._defaultAlignment:e.hAlign,this._imCtrl.getValue())||0,s.style.textAlign=this._hAlignArray[i],(o=e.backColor)&&(s.style.backgroundColor=o),(r=e.foreColor)&&(s.style.color=r),this.updateControlFont(t,p,e.font))},e.prototype.updateControlFont=function(t,e,n){var i=this,o=e.zoom();this._imCtrl.getUIInputElement().style.font=f.Core._getZoomFont(n,o).font,this._const_icon_spin_buttons.split(",").forEach(function(e){var n=t.getElementsByClassName(e);0<n.length&&(n[0].style.backgroundSize=i._const_button_font_size*o+i._const_unit)})},e.prototype.adjustBorder=function(t,e,n){null==n?e.style.cssText+=t:this.addStyle(t,e,n)},e.prototype.addStyle=function(t,e,n){e!=n?(e.style.cssText+=t,this.addStyle(t,e.parentElement,n)):n.style.cssText+=t},e.prototype.deactivateEditor=function(t,e){this._imCtrl=null;var n=this.getOriginalInput(t);t.innerHTML="",t.appendChild(n),n.focus(),f.Core._dispose()},e.prototype.getEditorValue=function(t,e){if(!this._imCtrl)return null;var n=document.createEvent("HTMLEvents");n.initEvent("blur",!0,!0),this._imCtrl.getUIInputElement().dispatchEvent(n);var i=this.displayType?this.displayType:this._config.displayType,o=this._imCtrl.getValue();return null==o||""===o?null:i&&i==a.Text?"'"+this._imCtrl.getText():o},e.prototype.setEditorValue=function(t,e,n){if(this._imCtrl)try{(this.displayType?this.displayType:this._config.displayType)==a.Text?0==e.indexOf("'")?this._imCtrl.setText(e.toString().substring(1)):this._imCtrl.setText(e):this._imCtrl.setValue(e)}catch(t){}},e.prototype.focus=function(t,e){if(this._imCtrl)this._imCtrl.setFocus();else{var n=this.getOriginalInput(t);n&&n.focus()}},e.prototype.selectAll=function(t,e){this._imCtrl&&(this._imCtrl.setFocus(),this._imCtrl.selectAll())},e.prototype.isImeAware=function(t){return!0},e.prototype.toJSON=function(){var t=JSON.parse(JSON.stringify(this._config));return this._typeManager&&this._typeManager.getUsedProperties().forEach(function(e){t[e.key]=e.value}),t.typeName=this.typeName,t},e.prototype.fromJSON=function(t){t&&(delete t.typeName,this._config=t)},e.prototype.isReservedKey=function(t,e){var n=[37,39,38,40];if(this._imCtrl){var i=this._imCtrl.getLayoutElement().getElementsByClassName("gcim-dropdown");0<i.length&&(i[0].classList.contains("gcim-dropdown_close")||n.push(13))}var o=t.keyCode,r=t.ctrlKey,p=t.metaKey,s=e.sheet;return s&&s.isEditing()&&this._isControlActived&&(0<=n.indexOf(o)||65===o&&(r||p)||67===o&&(r||p)||86===o&&(r||p)||88===o&&(r||p))},e.prototype.getDirectionFromKeyCode=function(t){if(this._isExiting)return this.getExitDirection(t);if(this.isDisableSpinByKeys()){if(38===t)return p.up;if(40===t)return p.down}return p.none},e.prototype.getExitDirection=function(t){return 39===t?p.right:37===t?p.left:p.right},e.prototype.isDisableSpinByKeys=function(){return!1===this.getFinalPropertyValue("allowSpin")},e.prototype.getFinalPropertyValue=function(t){return void 0!==this[t]?this[t]:void 0!==this._config[t]?this._config[t]:void 0},e.prototype.raiseEvent=function(t,e){var n=this.getFinalPropertyValue(t),i={celltype:this,sheet:e.sheet,row:e.row,col:e.col,sheetArea:e.sheetArea};"function"==typeof n?n.apply(this,[i]):"string"==typeof n&&"function"==typeof window[n]&&window[n].apply(this,[i])},e.prototype.mergeObject=function(t,e){var n=this;return Object.keys(t).forEach(function(i){void 0===e[i]?e[i]=t[i]:"object"==typeof t[i]&&n.mergeObject(t[i],e[i])}),e},e.prototype.getOriginalInput=function(t){return t.querySelector("input."+this._gcim_Input_Helper)},r([h()],e.prototype,"exitOnLeftRightKey",void 0),r([h()],e.prototype,"editMode",void 0),r([h()],e.prototype,"watermarkNullText",void 0),r([h()],e.prototype,"acceptsCrlf",void 0),e}(c.Spread.Sheets.CellTypes.Base);e.GcInputManCellType=d,(s=p=e.Direction||(e.Direction={}))[s.right=0]="right",s[s.left=1]="left",s[s.up=2]="up",s[s.down=3]="down",s[s.none=4]="none",(l=a=e.DisplayType||(e.DisplayType={})).Value="value",l.Text="text"},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,p=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(p=(r<3?o(p):3<r?o(e,n,p):o(e,n))||p);return 3<r&&p&&Object.defineProperty(e,n,p),p};Object.defineProperty(e,"__esModule",{value:!0});var p=n(2),s=n(0),a=n(1).TypeManager.Property,l=function(t){function e(e){var n=t.call(this,e)||this;return n._defaultProperties={allowDeleteToNull:!0},n._defaultText="####0.##",n.typeName="GC.Spread.Sheets.CellTypes.GcNumberCellType",n._defaultAlignment=2,n}return o(e,t),e.prototype.createGcInputManControl=function(t){return new s.InputMan.GcNumber(t,this.mergeObject(this._defaultProperties,this._config))},e.prototype.bindEvent=function(e){var n=this;this._imCtrl&&(t.prototype.bindEvent.call(this,e),this._imCtrl.onSpinDown(function(t){n.raiseEvent("spinDown",e)}),this._imCtrl.onSpinUp(function(t){n.raiseEvent("spinUp",e)}),this._imCtrl.onInvalidRange(function(t){n.raiseEvent("invalidRange",e)}))},e.prototype.getBaseInputSize=function(e,n){var i=t.prototype.getBaseInputSize.call(this,e,n);if(i)return this._config.showSpinButton&&this._config.spinButtonPosition==s.InputMan.SpinButtonAlignment.LeftSide&&(i.left+=i.buttonWidth),this._config.showNumericPad&&this._config.numericPadPosition==s.InputMan.DropDownButtonAlignment.LeftSide&&(i.left+=i.buttonWidth),i},r([a()],e.prototype,"watermarkZeroText",void 0),r([a()],e.prototype,"formatDigit",void 0),r([a()],e.prototype,"maxValue",void 0),r([a()],e.prototype,"minValue",void 0),r([a()],e.prototype,"positivePrefix",void 0),r([a()],e.prototype,"positiveSuffix",void 0),r([a()],e.prototype,"negativePrefix",void 0),r([a()],e.prototype,"negativeSuffix",void 0),r([a()],e.prototype,"valueSign",void 0),r([a()],e.prototype,"adjustValueOnFocus",void 0),r([a()],e.prototype,"allowDeleteToNull",void 0),r([a()],e.prototype,"acceptsDecimal",void 0),r([a()],e.prototype,"currencySymbol",void 0),r([a()],e.prototype,"decimalPoint",void 0),r([a()],e.prototype,"maxMinBehavior",void 0),r([a()],e.prototype,"separator",void 0),r([a()],e.prototype,"highlightText",void 0),r([a()],e.prototype,"allowSpin",void 0),r([a()],e.prototype,"clipContent",void 0),e}(p.GcInputManCellType);e.GcNumberCellType=l},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,p=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(p=(r<3?o(p):3<r?o(e,n,p):o(e,n))||p);return 3<r&&p&&Object.defineProperty(e,n,p),p};Object.defineProperty(e,"__esModule",{value:!0});var p=n(2),s=n(0),a=n(1).TypeManager.Property,l=function(t){function e(e){var n=t.call(this,e)||this;return n._defaultProperties={displayType:"text"},n._defaultText="0",n.typeName="GC.Spread.Sheets.CellTypes.GcMaskCellType",n._defaultAlignment=0,n}return o(e,t),e.prototype.createGcInputManControl=function(t){return new s.InputMan.GcMask(t,this.mergeObject(this._defaultProperties,this._config))},e.prototype.bindEvent=function(e){var n=this;this._imCtrl&&(t.prototype.bindEvent.call(this,e),this._imCtrl.onSpinUp(function(t){n.raiseEvent("spinUp",e)}),this._imCtrl.onSpinDown(function(t){n.raiseEvent("spinDown",e)}))},e.prototype.getBaseInputSize=function(e,n){var i=t.prototype.getBaseInputSize.call(this,e,n);if(i)return this._config.showSpinButton&&this._config.spinButtonPosition==s.InputMan.SpinButtonAlignment.LeftSide&&(i.left+=i.buttonWidth),i},e.prototype.processNavigationAction=function(e){var n=this;this._imCtrl.getUIInputElement().addEventListener("keypress",function(t){try{n._isExiting&&e.sheet.parent.commandManager().execute({cmd:"moveToNextCell",sheetName:e.sheet.name()})}finally{n._isExiting=!1}}),t.prototype.processNavigationAction.call(this,e)},e.prototype.setEditorValue=function(t,e,n){if(this._imCtrl)try{(this.displayType?this.displayType:this._config.displayType)==p.DisplayType.Text?(0==e.indexOf("'")&&this._imCtrl.setText(e.toString().substring(1)),this._imCtrl.setText(e)):this._imCtrl.setValue(e?String(e):e)}catch(t){}},r([a()],e.prototype,"autoConvert",void 0),r([a()],e.prototype,"formatPattern",void 0),r([a()],e.prototype,"promptChar",void 0),r([a()],e.prototype,"showLiterals",void 0),r([a()],e.prototype,"clipContent",void 0),r([a()],e.prototype,"allowSpin",void 0),r([a()],e.prototype,"exitOnLastChar",void 0),e}(p.GcInputManCellType);e.GcMaskCellType=l},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,p=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(p=(r<3?o(p):3<r?o(e,n,p):o(e,n))||p);return 3<r&&p&&Object.defineProperty(e,n,p),p};Object.defineProperty(e,"__esModule",{value:!0});var p=n(2),s=n(0),a=n(1).TypeManager.Property,l=function(t){function e(e){var n=t.call(this,e)||this;return n._defaultProperties={dropDownConfig:{dropDownType:s.InputMan.DateDropDownType.Calendar}},n._defaultText="yyyy/MM/dd HH:mm:ss",n.typeName="GC.Spread.Sheets.CellTypes.GcDateTimeCellType",n._defaultAlignment=2,n}return o(e,t),e.prototype.createGcInputManControl=function(t){return new s.InputMan.GcDateTime(t,this.mergeObject(this._defaultProperties,this._config))},e.prototype.bindEvent=function(e){var n=this;this._imCtrl&&(t.prototype.bindEvent.call(this,e),this._imCtrl.onSpinDown(function(t){n.raiseEvent("spinDown",e)}),this._imCtrl.onSpinUp(function(t){n.raiseEvent("spinUp",e)}),this._imCtrl.onInvalidRange(function(t){n.raiseEvent("invalidRange",e)}),this._imCtrl.onInvalidValue(function(t){n.raiseEvent("invalidValue",e)}),this.processHolidayGroup())},e.prototype.processHolidayGroup=function(){if(void 0!==this._config.dropDownConfig&&void 0!==this._config.dropDownConfig.dropDownType&&this._config.dropDownConfig.dropDownType==s.InputMan.DateDropDownType.Calendar){var t=this._imCtrl.getDropDownCalendar();t&&this._holidayGroup&&t.addHolidayGroup(this._holidayGroup)}},e.prototype.getBaseInputSize=function(e,n){var i=t.prototype.getBaseInputSize.call(this,e,n);if(i)return this._config.showSpinButton&&this._config.spinButtonPosition==s.InputMan.SpinButtonAlignment.LeftSide&&(i.left+=i.buttonWidth),this._config.showDropDownButton&&this._config.dropDownButtonAlignment==s.InputMan.DropDownButtonAlignment.LeftSide&&(i.left+=i.buttonWidth),i},e.prototype.addHolidayGroup=function(t){this._holidayGroup=t},e.prototype.isDisableSpinByKeys=function(){return t.prototype.isDisableSpinByKeys.call(this)||!1===this.getFinalPropertyValue("spinOnKeys")},e.prototype.setEditorValue=function(t,e,n){if(this._imCtrl)try{this.ProcessMaxMinBehaviorForDropDownCalendar(e,n),(this.displayType?this.displayType:this._config.displayType)==p.DisplayType.Text?e?0==e.indexOf("'")?this._imCtrl.setText(e.toString().substring(1)):this._imCtrl.setText(e):this._imCtrl.clear():this._imCtrl.setValue(e)}catch(t){}},e.prototype.ProcessMaxMinBehaviorForDropDownCalendar=function(t,e){var n=t;if(null!=t&&t&&-1!=t.valueOf()){var i=this.maxDate?this.maxDate:this._config.maxDate,o=this.minDate?this.minDate:this._config.minDate;if(i&&new Date(t)>new Date(i.toString())||o&&new Date(t)<new Date(o.toString()))switch(this.raiseEvent("invalidRange",e),this.maxMinBehavior?this.maxMinBehavior:this._config.maxMinBehavior){case s.InputMan.MaxMinBehavior.AdjustToMaxMin:n=i<t?new Date(i.toString()):new Date(o.toString());break;case s.InputMan.MaxMinBehavior.Clear:n=null;break;case s.InputMan.MaxMinBehavior.Keep:case s.InputMan.MaxMinBehavior.CancelInput:case s.InputMan.MaxMinBehavior.Restore:n=t}}return n},r([a()],e.prototype,"maxDate",void 0),r([a()],e.prototype,"minDate",void 0),r([a()],e.prototype,"formatPattern",void 0),r([a()],e.prototype,"spinIncrement",void 0),r([a()],e.prototype,"spinOnKeys",void 0),r([a()],e.prototype,"spinWrap",void 0),r([a()],e.prototype,"allowSpin",void 0),r([a()],e.prototype,"watermarkEmptyEraText",void 0),r([a()],e.prototype,"promptChar",void 0),r([a()],e.prototype,"AMDesignator",void 0),r([a()],e.prototype,"PMDesignator",void 0),r([a()],e.prototype,"twoDigitYearMax",void 0),r([a()],e.prototype,"hour12Mode",void 0),r([a()],e.prototype,"maxMinBehavior",void 0),r([a()],e.prototype,"midnightAs24",void 0),r([a()],e.prototype,"showLiterals",void 0),r([a()],e.prototype,"adjustValueOnFocus",void 0),r([a()],e.prototype,"useTwoDigitYearMax",void 0),r([a()],e.prototype,"validateMode",void 0),r([a()],e.prototype,"clipContent",void 0),r([a()],e.prototype,"exitOnLastChar",void 0),e}(p.GcInputManCellType);e.GcDateTimeCellType=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(3),n(4),n(5);var i=n(3);e.GcNumberCellType=i.GcNumberCellType;var o=n(4);e.GcMaskCellType=o.GcMaskCellType;var r=n(5);e.GcDateTimeCellType=r.GcDateTimeCellType},function(t,n){t.exports=e},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.find=function(t,e,n){var i=null;return Array.isArray(t)&&t.forEach(function(t,o){var r=t;"function"==typeof n&&(r=n(t)),r===e&&(i={item:t,index:o})}),i},t}();e.ArrayHelper=i;var o=function(){function t(){}return t.isEmpty=function(t){return null==t||""===t},t}();e.Common=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t._getHAlignByValueType=function(e,n,i){if(3===e){var o=t._getType(n);e=void 0!==i&&"@"===i?0:"boolean"===o?1:"number"===o||"date"===o?2:0}return e},t._getType=function(e){if(null===e)return"null";var n=t._type;if(!n){n=t._type={};for(var i=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],o=0,r=i.length;o<r;o++)n["[object "+i[o]+"]"]=i[o].toLowerCase()}var p=n.toString,s=typeof e;return"object"===s||"function"===s?n[p.call(e)]||"object":s},t._getZoomFont=function(e,n){var i=t._getMeasureSpan();i.style.font=e;var o=i.currentStyle,r=document.defaultView;r&&r.getComputedStyle&&(o=r.getComputedStyle(i,""));var p=o.fontSize,s="px";if(-1!==p.indexOf(s)){var a=Math.max(1,Math.floor(parseFloat(p.replace(s,""))*n));p=a+s}var l=o.lineHeight;return-1!==l.indexOf(s)&&(l=Math.max(1,Math.floor(parseFloat(l.replace(s,""))*n))+s),1===n?{font:e,fontSize:a}:(i.style.fontSize=p,i.style.lineHeight=l,{font:i.style.font,fontSize:a})},t._getMeasureSpan=function(){if(!t._measureSpan){var e="-10000px",n=document.createElement("span"),i=n.style;i.visibility="hidden",i.top=e,i.left=e,i.lineHeight="normal",i.position="absolute",i.fontWeight="normal",i.fontStretch="normal",i.fontVariant="normal",i.fontStyle="normal",document.body.insertBefore(n,null),t._measureSpan=n}return t._measureSpan},t._dispose=function(){var e=t._measureSpan;e&&(document.body.removeChild(e),t._measureSpan=null)},t._getCellOffsetArray=function(t){var e=["0px","0px","0px","0px"];if("string"==typeof t){var n,i,o=t.split(" ",4),r=o.length;1===r?e=[n=o[0],n,n,n]:2===r?e=[n=o[0],i=o[1],n,i]:3===r?(i=o[1],e=[o[0],i,o[2],i]):4===r&&(e=[o[0],o[1],o[2],o[3]])}var p=[];return e.forEach(function(t){p.push(isNaN(parseInt(t))?0:parseInt(t))}),p},t}();e.Core=i}])});